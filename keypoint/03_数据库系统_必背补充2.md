# 第3章：数据库系统 - 必背补充内容（续）

## 3.AA 易错点提醒 ⭐⭐⭐⭐⭐

### 易错点1：范式判断
```
❌ 错误：有部分依赖就是2NF
✅ 正确：有部分依赖只满足1NF

判断流程：
1. 属性原子 → 1NF
2. 无部分依赖 → 2NF
3. 无传递依赖 → 3NF
4. 决定因素都包含候选键 → BCNF

记忆：
- 有部分依赖 → 1NF
- 有传递依赖 → 2NF
- 都没有 → 3NF
```

### 易错点2：完全依赖 vs 部分依赖
```
❌ 错误：只要能决定就是完全依赖
✅ 正确：真子集不能决定才是完全依赖

完全依赖：
- (学号,课程号)→成绩
- 学号不能决定成绩
- 课程号不能决定成绩
- 必须两个一起才能决定

部分依赖：
- (学号,课程号)→学生姓名
- 只需学号就能决定学生姓名
- 课程号是多余的

记忆：完全依赖=真子集不够用
```

### 易错点3：候选键求法
```
❌ 错误：只在左边的属性就是候选键
✅ 正确：只在左边的属性必在候选键中，但不一定是全部

步骤：
1. 找只在左边的属性（必在）
2. 计算闭包
3. 如果不够，加上两边都有的属性
4. 验证是否包含全部属性

记忆：只左必在，但可能不够
```

### 易错点4：无损分解判断
```
❌ 错误：有公共属性就是无损分解
✅ 正确：公共属性能决定某个关系的其他属性才是无损

判断：
R1∩R2 → (R1-R2) 或 R1∩R2 → (R2-R1)

记忆：
- 有公共属性 ≠ 无损分解
- 公共属性能决定 = 无损分解
```

### 易错点5：封锁协议级别
```
❌ 错误：二级封锁协议解决不可重复读
✅ 正确：三级封锁协议才能解决不可重复读

区别：
- 二级：读完即释放S锁
- 三级：事务结束才释放S锁

记忆：
- 一级：丢失更新
- 二级：+读脏数据
- 三级：+不可重复读
```

### 易错点6：X锁和S锁
```
❌ 错误：S锁可以升级为X锁
✅ 正确：S锁和X锁互斥，不能同时存在

锁的兼容性：
- S锁 + S锁：兼容 ✓
- S锁 + X锁：不兼容 ✗
- X锁 + X锁：不兼容 ✗

记忆：
- S锁：共享锁，可以多个
- X锁：排它锁，只能一个
```

### 易错点7：SQL语句分类
```
❌ 错误：DELETE是DDL语句
✅ 正确：DELETE是DML语句

区别：
- DROP：DDL，删除表结构
- DELETE：DML，删除表数据
- TRUNCATE：DDL，清空表数据

记忆：
- DROP删结构
- DELETE删数据（可回滚）
- TRUNCATE清数据（不可回滚）
```

## 3.BB 真题精选 ⭐⭐⭐⭐⭐

### 真题1（2022年）
关系R(学号,课程号,成绩,学分)，学分由课程号决定，该关系属于（）。
A. 1NF  B. 2NF  C. 3NF  D. BCNF

**答案**：A
**解析**：学分部分依赖于候选键(学号,课程号)，只满足1NF。

### 真题2（2021年）
关系R(A,B,C,D)，F={A→B, C→D}，候选键是（）。
A. A  B. C  C. AC  D. AB

**答案**：C
**解析**：A只能决定B，C只能决定D，需要AC才能决定全部。

### 真题3（2020年）
要解决"不可重复读"问题，至少需要采用（）封锁协议。
A. 一级  B. 二级  C. 三级  D. 四级

**答案**：C
**解析**：三级封锁协议读前加S锁，事务结束才释放，可以解决不可重复读。

### 真题4（2019年）
以下哪个不是DML语句？
A. SELECT  B. INSERT  C. CREATE  D. DELETE

**答案**：C
**解析**：CREATE是DDL语句，用于创建表结构。

### 真题5（2018年）
关系R(A,B,C)，F={A→B, B→C}，分解为R1(A,B)和R2(B,C)是否无损？
A. 是  B. 否  C. 不确定  D. 需要更多信息

**答案**：A
**解析**：公共属性B能决定C，满足无损分解条件。

### 真题6（2017年）
事务的ACID特性中，A代表（）。
A. 原子性  B. 一致性  C. 隔离性  D. 持久性

**答案**：A
**解析**：ACID分别代表原子性、一致性、隔离性、持久性。

## 3.CC 考试答题技巧 ⭐⭐⭐⭐⭐

### 技巧1：范式快速判断
```
看函数依赖类型：
1. 有部分依赖 → 1NF
2. 无部分依赖，有传递依赖 → 2NF
3. 无部分依赖，无传递依赖 → 3NF
4. 所有决定因素都包含候选键 → BCNF

快速识别：
- "部分依赖" → 1NF
- "传递依赖" → 2NF
- "都没有" → 3NF
```

### 技巧2：候选键求解
```
三步法：
1. 找只在左边的属性（必在候选键）
2. 计算闭包
3. 验证是否包含全部属性

如果不够：
- 加上两边都有的属性
- 再计算闭包
- 直到包含全部属性
```

### 技巧3：无损分解判断
```
两个关系：
1. 找公共属性 R1∩R2
2. 看公共属性能否决定某个关系的其他属性
3. 能决定 → 无损，不能 → 有损

多个关系：
- 使用表格法
- 画表格，标记√和×
- 根据函数依赖更新
- 有全√行 → 无损
```

### 技巧4：封锁协议选择
```
看要解决的问题：
- 丢失更新 → 一级
- 读脏数据 → 二级
- 不可重复读 → 三级

记忆：
- 一级：1个问题
- 二级：2个问题
- 三级：3个问题
```

### 技巧5：SQL语句分类
```
看关键词：
- CREATE, ALTER, DROP → DDL
- SELECT, INSERT, UPDATE, DELETE → DML
- GRANT, REVOKE → DCL
- COMMIT, ROLLBACK → TCL

记忆：
- 定义结构 → DDL
- 操作数据 → DML
- 控制权限 → DCL
- 控制事务 → TCL
```

### 技巧6：函数依赖判断
```
看决定关系：
- 真子集不能决定 → 完全依赖
- 真子集能决定 → 部分依赖
- 通过中间属性 → 传递依赖

例子：
- (A,B)→C，A不能决定C，B不能决定C → 完全
- (A,B)→C，A能决定C → 部分
- A→B，B→C → 传递
```

### 技巧7：并发问题识别
```
看操作序列：
- 两个写操作 → 丢失更新
- 读未提交的数据 → 读脏数据
- 两次读结果不同 → 不可重复读

记忆：
- 写写 → 丢失更新
- 读未提交 → 读脏数据
- 读读不同 → 不可重复读
```

---

## 3.DD 综合练习题 ⭐⭐⭐⭐⭐

### 练习1：范式分解
关系R(学号,姓名,系号,系名,课程号,成绩)
函数依赖：学号→(姓名,系号)，系号→系名，(学号,课程号)→成绩

**问题**：
1. 该关系属于第几范式？
2. 如何分解到3NF？

**解答**：
```
1. 判断范式：
   - 候选键：(学号,课程号)
   - 系名传递依赖于候选键：学号→系号→系名
   - 存在传递依赖，满足2NF

2. 分解到3NF：
   - R1(学号,姓名,系号)：学号→(姓名,系号)
   - R2(系号,系名)：系号→系名
   - R3(学号,课程号,成绩)：(学号,课程号)→成绩
   
   消除了传递依赖，满足3NF
```

### 练习2：候选键求解
关系R(A,B,C,D,E)
函数依赖：AB→C, C→D, D→E, E→B

**问题**：求候选键

**解答**：
```
步骤1：分析属性
- 只在左边：A（必在候选键）
- 只在右边：无
- 两边都有：B,C,D,E
- 两边都无：无

步骤2：计算闭包
A+ = {A}（不够）
AB+ = {A,B,C,D,E}（全部）✓
AC+ = {A,C,D,E,B}（全部）✓

候选键：AB, AC
```

### 练习3：无损分解验证
关系R(A,B,C,D)
函数依赖：A→B, B→C, C→D
分解为：R1(A,B), R2(B,C), R3(C,D)

**问题**：验证是否无损分解

**解答**：
```
使用表格法：

初始表格：
     A  B  C  D
R1   √  √  ×  ×
R2   ×  √  √  ×
R3   ×  ×  √  √

应用A→B：R1行不变（A,B都是√）
应用B→C：R1,R2的B都是√，C改为√
     A  B  C  D
R1   √  √  √  ×
R2   ×  √  √  ×
R3   ×  ×  √  √

应用C→D：R1,R2,R3的C都是√，D改为√
     A  B  C  D
R1   √  √  √  √  ← 全√
R2   ×  √  √  √
R3   ×  ×  √  √

有全√行，无损分解 ✓
```

---

**本章学习建议**：
1. 重点掌握范式判断方法（必考）
2. 熟练掌握候选键求解步骤
3. 理解无损分解的判断方法
4. 记住封锁协议解决的问题
5. 掌握SQL语句的分类
6. 多做函数依赖和范式分解的练习题
7. 使用口诀和对比表辅助记忆
8. 真题中的范式题要画出函数依赖图
