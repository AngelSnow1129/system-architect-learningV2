<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç³»ç»Ÿè¯Šæ–­ - ç³»ç»Ÿæ¶æ„è®¾è®¡å¸ˆå­¦ä¹ å¹³å°</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@5.2.0/github-markdown.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f7fa;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #667eea;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .test-item {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 5px;
        }
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 3px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        .status.warning {
            background: #fff3cd;
            color: #856404;
        }
        .status.loading {
            background: #d1ecf1;
            color: #0c5460;
        }
        button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #764ba2;
        }
        .code {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 10px 0;
        }
        .info {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ ç³»ç»Ÿè¯Šæ–­</h1>

        <div class="info">
            <strong>ğŸ“ è¯´æ˜ï¼š</strong> è¿™ä¸ªé¡µé¢ä¼šè‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿå„é¡¹åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚
        </div>

        <button onclick="runAllTests()">ğŸš€ è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
        <button onclick="location.reload()">ğŸ”„ é‡æ–°åŠ è½½</button>
        <button onclick="window.location.href='index.html'">ğŸ  è¿”å›ä¸»é¡µ</button>

        <div class="test-section">
            <h2>1. æµè§ˆå™¨ç¯å¢ƒæ£€æµ‹</h2>
            <div id="browser-test" class="test-item">
                <span>æµè§ˆå™¨ä¿¡æ¯ï¼š</span>
                <span class="status loading">æ£€æµ‹ä¸­...</span>
            </div>
        </div>

        <div class="test-section">
            <h2>2. CDNèµ„æºåŠ è½½æ£€æµ‹</h2>
            <div id="marked-test" class="test-item">
                <span>Marked.js åº“ï¼š</span>
                <span class="status loading">æ£€æµ‹ä¸­...</span>
            </div>
            <div id="css-test" class="test-item">
                <span>GitHub Markdown CSSï¼š</span>
                <span class="status loading">æ£€æµ‹ä¸­...</span>
            </div>
        </div>

        <div class="test-section">
            <h2>3. æ–‡ä»¶è®¿é—®æµ‹è¯•</h2>
            <div id="file-test" class="test-item">
                <span>æµ‹è¯•æ–‡ä»¶åŠ è½½ï¼š</span>
                <span class="status loading">æ£€æµ‹ä¸­...</span>
            </div>
        </div>

        <div class="test-section">
            <h2>4. Markdownè§£ææµ‹è¯•</h2>
            <div id="parse-test" class="test-item">
                <span>Markdownè§£æï¼š</span>
                <span class="status loading">æ£€æµ‹ä¸­...</span>
            </div>
            <div id="parse-result"></div>
        </div>

        <div class="test-section">
            <h2>5. ç½‘ç»œè¿æ¥æµ‹è¯•</h2>
            <div id="network-test" class="test-item">
                <span>ç½‘ç»œçŠ¶æ€ï¼š</span>
                <span class="status loading">æ£€æµ‹ä¸­...</span>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ“Š è¯Šæ–­ç»“æœ</h2>
            <div id="summary"></div>
        </div>
    </div>

    <script>
        let testResults = {
            browser: false,
            marked: false,
            css: false,
            file: false,
            parse: false,
            network: false
        };

        // 1. æµè§ˆå™¨ç¯å¢ƒæ£€æµ‹
        function testBrowser() {
            const browserDiv = document.getElementById('browser-test');
            const info = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                online: navigator.onLine
            };

            browserDiv.innerHTML = `
                <div>
                    <strong>æµè§ˆå™¨ï¼š</strong> ${navigator.userAgent.match(/(Chrome|Firefox|Safari|Edge|Opera)/)?.[0] || 'Unknown'}
                    <span class="status success">âœ“</span>
                </div>
                <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                    å¹³å°: ${info.platform}<br>
                    è¯­è¨€: ${info.language}<br>
                    åœ¨çº¿: ${info.online ? 'æ˜¯' : 'å¦'}
                </div>
            `;
            testResults.browser = true;
        }

        // 2. Marked.js æ£€æµ‹
        function testMarked() {
            const markedDiv = document.getElementById('marked-test');
            
            setTimeout(() => {
                if (typeof marked !== 'undefined') {
                    markedDiv.innerHTML = `
                        <span>Marked.js åº“ï¼š</span>
                        <span class="status success">âœ“ å·²åŠ è½½</span>
                        <div style="margin-top: 5px; font-size: 0.9em; color: #666;">
                            ç‰ˆæœ¬: ${marked.version || 'æœªçŸ¥'}
                        </div>
                    `;
                    testResults.marked = true;
                } else {
                    markedDiv.innerHTML = `
                        <span>Marked.js åº“ï¼š</span>
                        <span class="status error">âœ— æœªåŠ è½½</span>
                        <div style="margin-top: 5px; font-size: 0.9em; color: #721c24;">
                            CDNå¯èƒ½æ— æ³•è®¿é—®ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥
                        </div>
                    `;
                    testResults.marked = false;
                }
                updateSummary();
            }, 2000);
        }

        // 3. CSS æ£€æµ‹
        function testCSS() {
            const cssDiv = document.getElementById('css-test');
            // ç®€å•æ£€æµ‹ï¼Œå®é™…CSSåŠ è½½è¾ƒéš¾æ£€æµ‹
            cssDiv.innerHTML = `
                <span>GitHub Markdown CSSï¼š</span>
                <span class="status success">âœ“ å·²å¼•å…¥</span>
            `;
            testResults.css = true;
        }

        // 4. æ–‡ä»¶è®¿é—®æµ‹è¯•
        async function testFile() {
            const fileDiv = document.getElementById('file-test');
            
            try {
                const response = await fetch('../01_è®¡ç®—æœºç¡¬ä»¶.md');
                if (response.ok) {
                    const text = await response.text();
                    fileDiv.innerHTML = `
                        <span>æµ‹è¯•æ–‡ä»¶åŠ è½½ï¼š</span>
                        <span class="status success">âœ“ æˆåŠŸ</span>
                        <div style="margin-top: 5px; font-size: 0.9em; color: #666;">
                            æ–‡ä»¶å¤§å°: ${(text.length / 1024).toFixed(2)} KB
                        </div>
                    `;
                    testResults.file = true;
                } else {
                    throw new Error('HTTP ' + response.status);
                }
            } catch (error) {
                fileDiv.innerHTML = `
                    <span>æµ‹è¯•æ–‡ä»¶åŠ è½½ï¼š</span>
                    <span class="status error">âœ— å¤±è´¥</span>
                    <div style="margin-top: 5px; font-size: 0.9em; color: #721c24;">
                        é”™è¯¯: ${error.message}
                    </div>
                `;
                testResults.file = false;
            }
            updateSummary();
        }

        // 5. Markdownè§£ææµ‹è¯•
        function testParse() {
            const parseDiv = document.getElementById('parse-test');
            const resultDiv = document.getElementById('parse-result');
            
            setTimeout(() => {
                if (typeof marked === 'undefined') {
                    parseDiv.innerHTML = `
                        <span>Markdownè§£æï¼š</span>
                        <span class="status error">âœ— æ— æ³•æµ‹è¯•</span>
                        <div style="margin-top: 5px; font-size: 0.9em; color: #721c24;">
                            Marked.js æœªåŠ è½½
                        </div>
                    `;
                    testResults.parse = false;
                    updateSummary();
                    return;
                }

                try {
                    const testMarkdown = '# æµ‹è¯•æ ‡é¢˜\n\nè¿™æ˜¯ä¸€ä¸ª**æµ‹è¯•**æ®µè½ã€‚\n\n- åˆ—è¡¨é¡¹1\n- åˆ—è¡¨é¡¹2';
                    const html = marked.parse(testMarkdown);
                    
                    parseDiv.innerHTML = `
                        <span>Markdownè§£æï¼š</span>
                        <span class="status success">âœ“ æˆåŠŸ</span>
                    `;
                    
                    resultDiv.innerHTML = `
                        <div style="margin-top: 10px;">
                            <strong>æµ‹è¯•è¾“å…¥ï¼š</strong>
                            <div class="code">${testMarkdown}</div>
                            <strong>è§£æç»“æœï¼š</strong>
                            <div class="markdown-body" style="padding: 15px; background: white; border-radius: 5px; margin-top: 10px;">
                                ${html}
                            </div>
                        </div>
                    `;
                    testResults.parse = true;
                } catch (error) {
                    parseDiv.innerHTML = `
                        <span>Markdownè§£æï¼š</span>
                        <span class="status error">âœ— å¤±è´¥</span>
                        <div style="margin-top: 5px; font-size: 0.9em; color: #721c24;">
                            é”™è¯¯: ${error.message}
                        </div>
                    `;
                    testResults.parse = false;
                }
                updateSummary();
            }, 2500);
        }

        // 6. ç½‘ç»œè¿æ¥æµ‹è¯•
        function testNetwork() {
            const networkDiv = document.getElementById('network-test');
            
            if (navigator.onLine) {
                networkDiv.innerHTML = `
                    <span>ç½‘ç»œçŠ¶æ€ï¼š</span>
                    <span class="status success">âœ“ åœ¨çº¿</span>
                `;
                testResults.network = true;
            } else {
                networkDiv.innerHTML = `
                    <span>ç½‘ç»œçŠ¶æ€ï¼š</span>
                    <span class="status error">âœ— ç¦»çº¿</span>
                `;
                testResults.network = false;
            }
            updateSummary();
        }

        // æ›´æ–°æ€»ç»“
        function updateSummary() {
            const summaryDiv = document.getElementById('summary');
            const total = Object.keys(testResults).length;
            const passed = Object.values(testResults).filter(v => v).length;
            const percentage = ((passed / total) * 100).toFixed(0);

            let statusClass = 'success';
            let statusText = 'âœ“ æ‰€æœ‰æµ‹è¯•é€šè¿‡';
            let recommendation = 'ç³»ç»Ÿè¿è¡Œæ­£å¸¸ï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨å­¦ä¹ å¹³å°ã€‚';

            if (passed < total) {
                if (passed >= total * 0.7) {
                    statusClass = 'warning';
                    statusText = 'âš  éƒ¨åˆ†æµ‹è¯•å¤±è´¥';
                    recommendation = 'ç³»ç»ŸåŸºæœ¬å¯ç”¨ï¼Œä½†æŸäº›åŠŸèƒ½å¯èƒ½å—é™ã€‚';
                } else {
                    statusClass = 'error';
                    statusText = 'âœ— å¤šé¡¹æµ‹è¯•å¤±è´¥';
                    recommendation = 'ç³»ç»Ÿå­˜åœ¨é—®é¢˜ï¼Œå»ºè®®æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œæµè§ˆå™¨è®¾ç½®ã€‚';
                }
            }

            summaryDiv.innerHTML = `
                <div class="test-item">
                    <h3 style="margin-top: 0;">${statusText}</h3>
                    <div style="margin: 15px 0;">
                        <strong>é€šè¿‡ç‡ï¼š</strong> ${passed}/${total} (${percentage}%)
                    </div>
                    <div style="margin: 15px 0;">
                        <strong>å»ºè®®ï¼š</strong> ${recommendation}
                    </div>
                    <div style="margin-top: 20px;">
                        <strong>è¯¦ç»†ç»“æœï¼š</strong>
                        <ul style="margin-top: 10px;">
                            <li>æµè§ˆå™¨ç¯å¢ƒ: ${testResults.browser ? 'âœ“' : 'âœ—'}</li>
                            <li>Marked.jsåº“: ${testResults.marked ? 'âœ“' : 'âœ—'}</li>
                            <li>CSSæ ·å¼: ${testResults.css ? 'âœ“' : 'âœ—'}</li>
                            <li>æ–‡ä»¶è®¿é—®: ${testResults.file ? 'âœ“' : 'âœ—'}</li>
                            <li>Markdownè§£æ: ${testResults.parse ? 'âœ“' : 'âœ—'}</li>
                            <li>ç½‘ç»œè¿æ¥: ${testResults.network ? 'âœ“' : 'âœ—'}</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        function runAllTests() {
            testBrowser();
            testMarked();
            testCSS();
            testFile();
            testParse();
            testNetwork();
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.onload = runAllTests;
    </script>
</body>
</html>
