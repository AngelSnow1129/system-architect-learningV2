<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ è½½æµ‹è¯•</title>
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
        }
        #result {
            margin-top: 20px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 5px;
            max-height: 400px;
            overflow-y: auto;
        }
        .loading {
            color: #666;
        }
        .success {
            color: green;
        }
        .error {
            color: red;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ MarkdownåŠ è½½æµ‹è¯•</h1>

    <div class="test-section">
        <h2>æµ‹è¯•è¯´æ˜</h2>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•Markdownæ–‡ä»¶çš„åŠ è½½å’Œè§£ææ€§èƒ½ã€‚</p>
    </div>

    <div class="test-section">
        <h2>é€‰æ‹©æµ‹è¯•æ–‡ä»¶</h2>
        <button onclick="testFile('../01_è®¡ç®—æœºç¡¬ä»¶.md')">æµ‹è¯•ï¼š01_è®¡ç®—æœºç¡¬ä»¶</button>
        <button onclick="testFile('../03_æ•°æ®åº“ç³»ç»Ÿ.md')">æµ‹è¯•ï¼š03_æ•°æ®åº“ç³»ç»Ÿ</button>
        <button onclick="testFile('../keypoint/03_æ•°æ®åº“ç³»ç»Ÿ_çŸ¥è¯†æçº².md')">æµ‹è¯•ï¼šæ•°æ®åº“çŸ¥è¯†æçº²</button>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="status" class="loading">ç­‰å¾…æµ‹è¯•...</div>
        <div id="stats"></div>
    </div>

    <div id="result"></div>

    <script>
        async function testFile(filePath) {
            const statusDiv = document.getElementById('status');
            const statsDiv = document.getElementById('stats');
            const resultDiv = document.getElementById('result');

            statusDiv.className = 'loading';
            statusDiv.textContent = 'æ­£åœ¨åŠ è½½æ–‡ä»¶...';
            statsDiv.innerHTML = '';
            resultDiv.innerHTML = '';

            const startTime = performance.now();

            try {
                // åŠ è½½æ–‡ä»¶
                const loadStart = performance.now();
                const response = await fetch(filePath);
                if (!response.ok) {
                    throw new Error('æ–‡ä»¶æœªæ‰¾åˆ°');
                }
                const markdown = await response.text();
                const loadEnd = performance.now();
                const loadTime = (loadEnd - loadStart).toFixed(2);

                statusDiv.textContent = 'æ­£åœ¨è§£æMarkdown...';

                // è§£æMarkdown
                const parseStart = performance.now();
                const html = marked.parse(markdown);
                const parseEnd = performance.now();
                const parseTime = (parseEnd - parseStart).toFixed(2);

                // æ¸²æŸ“HTML
                const renderStart = performance.now();
                resultDiv.innerHTML = html;
                const renderEnd = performance.now();
                const renderTime = (renderEnd - renderStart).toFixed(2);

                const totalTime = (performance.now() - startTime).toFixed(2);

                // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
                statusDiv.className = 'success';
                statusDiv.textContent = 'âœ… æµ‹è¯•å®Œæˆï¼';
                
                statsDiv.innerHTML = `
                    <h3>æ€§èƒ½ç»Ÿè®¡ï¼š</h3>
                    <ul>
                        <li>æ–‡ä»¶å¤§å°: ${(markdown.length / 1024).toFixed(2)} KB</li>
                        <li>åŠ è½½æ—¶é—´: ${loadTime} ms</li>
                        <li>è§£ææ—¶é—´: ${parseTime} ms</li>
                        <li>æ¸²æŸ“æ—¶é—´: ${renderTime} ms</li>
                        <li><strong>æ€»æ—¶é—´: ${totalTime} ms</strong></li>
                    </ul>
                    <p>HTMLé•¿åº¦: ${(html.length / 1024).toFixed(2)} KB</p>
                `;

                // å¦‚æœæ€»æ—¶é—´è¶…è¿‡2ç§’ï¼Œæ˜¾ç¤ºè­¦å‘Š
                if (totalTime > 2000) {
                    statsDiv.innerHTML += `<p style="color: orange;">âš ï¸ åŠ è½½æ—¶é—´è¾ƒé•¿ï¼Œå»ºè®®ä¼˜åŒ–</p>`;
                }

            } catch (error) {
                statusDiv.className = 'error';
                statusDiv.textContent = 'âŒ æµ‹è¯•å¤±è´¥';
                statsDiv.innerHTML = `<p>é”™è¯¯: ${error.message}</p><p>æ–‡ä»¶è·¯å¾„: ${filePath}</p>`;
            }
        }
    </script>
</body>
</html>
